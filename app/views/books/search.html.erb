<div class="container">
  <h1>Book Search</h1>
  
  <%# Title/Author search form %>
  <%= form_with url: search_books_path, method: :get, local: true do |f| %>
    <div style="margin-bottom: 10px;">
      <%= f.text_field :titleQuery, value: params[:titleQuery], placeholder: "Title", style: "width: 100%;" %>
    </div>
    <div style="margin-bottom: 10px;">
      <%= f.text_field :authorQuery, value: params[:authorQuery], placeholder: "Author", style: "width: 100%;" %>
    </div>
    <%# This div will be positioned in the flex container %>
    <div style="display: inline-block;">
      <%= f.submit "Search by Title/Author", class: "button" %>
    </div>
  <% end %>

  <%# ISBN photo search form - now separate from the first form %>
  <%= form_with url: search_by_isbns_books_path, 
                method: :post, 
                local: true, 
                multipart: true, 
                data: { controller: "file-upload" },
                style: "display: inline-block; margin-left: 10px;" do |f| %>
    <%= f.file_field :photos, 
                     multiple: true, 
                     accept: 'image/*', 
                     data: { 
                       target: "file-upload.fileInput", 
                       action: "change->file-upload#submitForm" 
                     }, 
                     style: "display: none;" %>
    <button type="button" 
            class="button" 
            data-action="file-upload#promptFileSelection">
      Search by ISBN Photos
    </button>
  <% end %>

  <% if @books.any? %>
    <div style="overflow-x: auto;">
      <table>
        <thead>
          <tr>
            <th>Title</th>
            <th>Author</th>
            <th>Level</th>
            <% if params[:detailed] == "true" %>
              <th>Series</th>
              <th>AR Points</th>
              <th>Interest Level</th>
              <th>Word Count</th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @books.each do |book| %>
            <tr>
              <td><%= book.title %></td>
              <td><%= book.author %></td>
              <td><%= book.atos_book_level %></td>
              <% if params[:detailed] == "true" %>
                <td><%= book.series %></td>
                <td><%= book.ar_points %></td>
                <td><%= book.interest_level %></td>
                <td><%= number_with_delimiter(book.word_count) %></td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% elsif params[:titleQuery].present? || params[:authorQuery].present? %> 
    <p><mark>No books found matching your search criteria</mark></p>
  <% end %>
</div>